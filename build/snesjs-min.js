//SNESJS by simplyianm

var TBL_EM=0;var TBL_MX=256;var TBL_Mx=512;var TBL_mX=768;var TBL_mx=1024;var OPCODE_A=0;var OPCODE_X=1;var OPCODE_Y=2;var OPCODE_Z=3;var OPCODE_S=4;var OPCODE_D=5;SNESJS=function(){}SNESJS.CPU=function(a){this.snes=a;this.regs=new SNESJS.CPU.Regs();this.aa=new SNESJS.CPU.Reg24();this.rd=new SNESJS.CPU.Reg24();this.sp=0;this.dp=0;this.opEII(0x00,"interrupt",0xfffe,0xffe6);this.opMF(0x01,"read_idpx","ora");this.opEII(0x02,"interrupt",0xfff4,0xffe4);this.opMF(0x03,"read_sr","ora");this.opMF(0x04,"adjust_dp","tsb");this.opMF(0x05,"read_dp","ora");this.opMF(0x06,"adjust_dp","asl");this.opMF(0x07,"read_ildp","ora");this.opA(0x08,"php");this.opMF(0x09,"read_const","ora");this.opM(0x0a,"asl_imm");this.opE(0x0b,"phd");this.opMF(0x0c,"adjust_addr","tsb");this.opMF(0x0d,"read_addr","ora");this.opMF(0x0e,"adjust_addr","asl");this.opMF(0x0f,"read_long","ora");this.opAII(0x10,"branch",0x80,0x00);this.opMF(0x11,"read_idpy","ora");this.opMF(0x12,"read_idp","ora");this.opMF(0x13,"read_isry","ora");this.opMF(0x14,"adjust_dp","trb");this.opMFI(0x15,"read_dpr","ora",OPCODE_X);this.opMF(0x16,"adjust_dpx","asl");this.opMF(0x17,"read_ildpy","ora");this.opAII(0x18,"flag",0x01,0x00);this.opMF(0x19,"read_addry","ora");this.opMII(0x1a,"adjust_imm",OPCODE_A,1);this.opE(0x1b,"tcs");this.opMF(0x1c,"adjust_addr","trb");this.opMF(0x1d,"read_addrx","ora");this.opMF(0x1e,"adjust_addrx","asl");this.opMF(0x1f,"read_longx","ora");this.opA(0x20,"jsr_addr");this.opMF(0x21,"read_idpx","and");this.opE(0x22,"jsr_long");this.opMF(0x23,"read_sr","and");this.opMF(0x24,"read_dp","bit");this.opMF(0x25,"read_dp","and");this.opMF(0x26,"adjust_dp","rol");this.opMF(0x27,"read_ildp","and");this.opE(0x28,"plp");this.opMF(0x29,"read_const","and");this.opM(0x2a,"rol_imm");this.opE(0x2b,"pld");this.opMF(0x2c,"read_addr","bit");this.opMF(0x2d,"read_addr","and");this.opMF(0x2e,"adjust_addr","rol");this.opMF(0x2f,"read_long","and");this.opAII(0x30,"branch",0x80,1);this.opMF(0x31,"read_idpy","and");this.opMF(0x32,"read_idp","and");this.opMF(0x33,"read_isry","and");this.opMFI(0x34,"read_dpr","bit",OPCODE_X);this.opMFI(0x35,"read_dpr","and",OPCODE_X);this.opMF(0x36,"adjust_dpx","rol");this.opMF(0x37,"read_ildpy","and");this.opAII(0x38,"flag",0x01,0x01);this.opMF(0x39,"read_addry","and");this.opMII(0x3a,"adjust_imm",OPCODE_A,-1);this.opAII(0x3b,"transfer_w",OPCODE_S,OPCODE_A);this.opMF(0x3c,"read_addrx","bit");this.opMF(0x3d,"read_addrx","and");this.opMF(0x3e,"adjust_addrx","rol");this.opMF(0x3f,"read_longx","and");this.opE(0x40,"rti");this.opMF(0x41,"read_idpx","eor");this.opA(0x42,"wdm");this.opMF(0x43,"read_sr","eor");this.opXI(0x44,"move",-1);this.opMF(0x45,"read_dp","eor");this.opMF(0x46,"adjust_dp","lsr");this.opMF(0x47,"read_ildp","eor");this.opMI(0x48,"push",OPCODE_A);this.opMF(0x49,"read_const","eor");this.opM(0x4a,"lsr_imm");this.opA(0x4b,"phk");this.opA(0x4c,"jmp_addr");this.opMF(0x4d,"read_addr","eor");this.opMF(0x4e,"adjust_addr","lsr");this.opMF(0x4f,"read_long","eor");this.opAII(0x50,"branch",0x40,0);this.opMF(0x51,"read_idpy","eor");this.opMF(0x52,"read_idp","eor");this.opMF(0x53,"read_isry","eor");this.opXI(0x54,"move",+1);this.opMFI(0x55,"read_dpr","eor",OPCODE_X);this.opMF(0x56,"adjust_dpx","lsr");this.opMF(0x57,"read_ildpy","eor");this.opAII(0x58,"flag",0x04,0x00);this.opMF(0x59,"read_addry","eor");this.opXI(0x5a,"push",OPCODE_Y);this.opAII(0x5b,"transfer_w",OPCODE_A,OPCODE_D);this.opA(0x5c,"jmp_long");this.opMF(0x5d,"read_addrx","eor");this.opMF(0x5e,"adjust_addrx","lsr");this.opMF(0x5f,"read_longx","eor");this.opA(0x60,"rts");this.opMF(0x61,"read_idpx","adc");this.opE(0x62,"per");this.opMF(0x63,"read_sr","adc");this.opMI(0x64,"write_dp",OPCODE_Z);this.opMF(0x65,"read_dp","adc");this.opMF(0x66,"adjust_dp","ror");this.opMF(0x67,"read_ildp","adc");this.opMI(0x68,"pull",OPCODE_A);this.opMF(0x69,"read_const","adc");this.opM(0x6a,"ror_imm");this.opE(0x6b,"rtl");this.opA(0x6c,"jmp_iaddr");this.opMF(0x6d,"read_addr","adc");this.opMF(0x6e,"adjust_addr","ror");this.opMF(0x6f,"read_long","adc");this.opAII(0x70,"branch",0x40,1);this.opMF(0x71,"read_idpy","adc");this.opMF(0x72,"read_idp","adc");this.opMF(0x73,"read_isry","adc");this.opMII(0x74,"write_dpr",OPCODE_Z,OPCODE_X);this.opMFI(0x75,"read_dpr","adc",OPCODE_X);this.opMF(0x76,"adjust_dpx","ror");this.opMF(0x77,"read_ildpy","adc");this.opAII(0x78,"flag",0x04,0x04);this.opMF(0x79,"read_addry","adc");this.opXI(0x7a,"pull",OPCODE_Y);this.opAII(0x7b,"transfer_w",OPCODE_D,OPCODE_A);this.opA(0x7c,"jmp_iaddrx");this.opMF(0x7d,"read_addrx","adc");this.opMF(0x7e,"adjust_addrx","ror");this.opMF(0x7f,"read_longx","adc");this.opA(0x80,"bra");this.opM(0x81,"sta_idpx");this.opA(0x82,"brl");this.opM(0x83,"sta_sr");this.opXI(0x84,"write_dp",OPCODE_Y);this.opMI(0x85,"write_dp",OPCODE_A);this.opXI(0x86,"write_dp",OPCODE_X);this.opM(0x87,"sta_ildp");this.opXII(0x88,"adjust_imm",OPCODE_Y,-1);this.opM(0x89,"read_bit_const");this.opMII(0x8a,"transfer",OPCODE_X,OPCODE_A);this.opA(0x8b,"phb");this.opXI(0x8c,"write_addr",OPCODE_Y);this.opMI(0x8d,"write_addr",OPCODE_A);this.opXI(0x8e,"write_addr",OPCODE_X);this.opMI(0x8f,"write_longr",OPCODE_Z);this.opAII(0x90,"branch",0x01,0);this.opM(0x91,"sta_idpy");this.opM(0x92,"sta_idp");this.opM(0x93,"sta_isry");this.opXII(0x94,"write_dpr",OPCODE_Y,OPCODE_X);this.opMII(0x95,"write_dpr",OPCODE_A,OPCODE_X);this.opXII(0x96,"write_dpr",OPCODE_X,OPCODE_Y);this.opM(0x97,"sta_ildpy");this.opMII(0x98,"transfer",OPCODE_Y,OPCODE_A);this.opMII(0x99,"write_addrr",OPCODE_A,OPCODE_Y);this.opE(0x9a,"txs");this.opXII(0x9b,"transfer",OPCODE_X,OPCODE_Y);this.opMI(0x9c,"write_addr",OPCODE_Z);this.opMII(0x9d,"write_addrr",OPCODE_A,OPCODE_X);this.opMII(0x9e,"write_addrr",OPCODE_Z,OPCODE_X);this.opMI(0x9f,"write_longr",OPCODE_X);this.opXF(0xa0,"read_const","ldy");this.opMF(0xa1,"read_idpx","lda");this.opXF(0xa2,"read_const","ldx");this.opMF(0xa3,"read_sr","lda");this.opXF(0xa4,"read_dp","ldy");this.opMF(0xa5,"read_dp","lda");this.opXF(0xa6,"read_dp","ldx");this.opMF(0xa7,"read_ildp","lda");this.opXII(0xa8,"transfer",OPCODE_A,OPCODE_Y);this.opMF(0xa9,"read_const","lda");this.opXII(0xaa,"transfer",OPCODE_A,OPCODE_X);this.opA(0xab,"plb");this.opXF(0xac,"read_addr","ldy");this.opMF(0xad,"read_addr","lda");this.opXF(0xae,"read_addr","ldx");this.opMF(0xaf,"read_long","lda");this.opAII(0xb0,"branch",0x01,1);this.opMF(0xb1,"read_idpy","lda");this.opMF(0xb2,"read_idp","lda");this.opMF(0xb3,"read_isry","lda");this.opXFI(0xb4,"read_dpr","ldy",OPCODE_X);this.opMFI(0xb5,"read_dpr","lda",OPCODE_X);this.opXFI(0xb6,"read_dpr","ldx",OPCODE_Y);this.opMF(0xb7,"read_ildpy","lda");this.opAII(0xb8,"flag",0x40,0x00);this.opMF(0xb9,"read_addry","lda");this.opX(0xba,"tsx");this.opXII(0xbb,"transfer",OPCODE_Y,OPCODE_X);this.opXF(0xbc,"read_addrx","ldy");this.opMF(0xbd,"read_addrx","lda");this.opXF(0xbe,"read_addry","ldx");this.opMF(0xbf,"read_longx","lda");this.opXF(0xc0,"read_const","cpy");this.opMF(0xc1,"read_idpx","cmp");this.opEI(0xc2,"pflag",0);this.opMF(0xc3,"read_sr","cmp");this.opXF(0xc4,"read_dp","cpy");this.opMF(0xc5,"read_dp","cmp");this.opMF(0xc6,"adjust_dp","dec");this.opMF(0xc7,"read_ildp","cmp");this.opXII(0xc8,"adjust_imm",OPCODE_Y,+1);this.opMF(0xc9,"read_const","cmp");this.opXII(0xca,"adjust_imm",OPCODE_X,-1);this.opA(0xcb,"wai");this.opXF(0xcc,"read_addr","cpy");this.opMF(0xcd,"read_addr","cmp");this.opMF(0xce,"adjust_addr","dec");this.opMF(0xcf,"read_long","cmp");this.opAII(0xd0,"branch",0x02,0);this.opMF(0xd1,"read_idpy","cmp");this.opMF(0xd2,"read_idp","cmp");this.opMF(0xd3,"read_isry","cmp");this.opE(0xd4,"pei");this.opMFI(0xd5,"read_dpr","cmp",OPCODE_X);this.opMF(0xd6,"adjust_dpx","dec");this.opMF(0xd7,"read_ildpy","cmp");this.opAII(0xd8,"flag",0x08,0x00);this.opMF(0xd9,"read_addry","cmp");this.opXI(0xda,"push",OPCODE_X);this.opA(0xdb,"stp");this.opA(0xdc,"jmp_iladdr");this.opMF(0xdd,"read_addrx","cmp");this.opMF(0xde,"adjust_addrx","dec");this.opMF(0xdf,"read_longx","cmp");this.opXF(0xe0,"read_const","cpx");this.opMF(0xe1,"read_idpx","sbc");this.opEI(0xe2,"pflag",1);this.opMF(0xe3,"read_sr","sbc");this.opXF(0xe4,"read_dp","cpx");this.opMF(0xe5,"read_dp","sbc");this.opMF(0xe6,"adjust_dp","inc");this.opMF(0xe7,"read_ildp","sbc");this.opXII(0xe8,"adjust_imm",OPCODE_X,+1);this.opMF(0xe9,"read_const","sbc");this.opA(0xea,"nop");this.opA(0xeb,"xba");this.opXF(0xec,"read_addr","cpx");this.opMF(0xed,"read_addr","sbc");this.opMF(0xee,"adjust_addr","inc");this.opMF(0xef,"read_long","sbc");this.opAII(0xf0,"branch",0x02,1);this.opMF(0xf1,"read_idpy","sbc");this.opMF(0xf2,"read_idp","sbc");this.opMF(0xf3,"read_isry","sbc");this.opE(0xf4,"pea");this.opMFI(0xf5,"read_dpr","sbc",OPCODE_X);this.opMF(0xf6,"adjust_dpx","inc");this.opMF(0xf7,"read_ildpy","sbc");this.opAII(0xf8,"flag",0x08,0x08);this.opMF(0xf9,"read_addry","sbc");this.opXI(0xfa,"pull",OPCODE_X);this.opA(0xfb,"xce");this.opE(0xfc,"jsr_iaddrx");this.opMF(0xfd,"read_addrx","sbc");this.opMF(0xfe,"adjust_addrx","inc");this.opMF(0xff,"read_longx","sbc")}SNESJS.CPU.prototype.execOp=function(a){switch(a){case 0x00:}}SNESJS.CPU.prototype.optable=[];SNESJS.CPU.prototype.op_readpc=function(){}SNESJS.CPU.prototype.opA=function(a,b){var c=this;var d=getFunctionByName("SNESJS.CPU.OPS."+b);this.optable[TBL_EM+a]=this.optable[TBL_MX+a]=this.optable[TBL_Mx+a]=this.optable[TBL_mX+a]=this.optable[TBL_mx+a]=function(){d(c)}}SNESJS.CPU.prototype.opAII=function(a,b,c,d){var e=this;var f=getFunctionByName("SNESJS.CPU.OPS."+b);this.optable[TBL_EM+a]=this.optable[TBL_MX+a]=this.optable[TBL_Mx+a]=this.optable[TBL_mX+a]=this.optable[TBL_mx+a]=function(){f(e,c,d)}}SNESJS.CPU.prototype.opE=function(a,b){var c=this;var d=getFunctionByName("SNESJS.CPU.OPS."+b+"_2");this.optable[TBL_EM+a]=function(){d(c)};var e=getFunctionByName("SNESJS.CPU.OPS."+b+"_3");this.optable[TBL_MX+a]=this.optable[TBL_Mx+a]=this.optable[TBL_mX+a]=this.optable[TBL_mx+a]=function(){e(c)}}SNESJS.CPU.prototype.opEI=function(a,b,c){var d=this;var e=getFunctionByName("SNESJS.CPU.OPS."+b+"_2");this.optable[TBL_EM+a]=function(){e(d,c)};var f=getFunctionByName("SNESJS.CPU.OPS."+b+"_3");this.optable[TBL_MX+a]=this.optable[TBL_Mx+a]=this.optable[TBL_mX+a]=this.optable[TBL_mx+a]=function(){f(d,c)}}SNESJS.CPU.prototype.opEII=function(a,b,c,d){var e=this;var f=getFunctionByName("SNESJS.CPU.OPS."+b+"_2");this.optable[TBL_EM+a]=function(){f(e,c,d)};var g=getFunctionByName("SNESJS.CPU.OPS."+b+"_3");this.optable[TBL_MX+a]=this.optable[TBL_Mx+a]=this.optable[TBL_mX+a]=this.optable[TBL_mx+a]=function(){g(e,c,d)}}SNESJS.CPU.prototype.opM=function(a,b){var c=this;var d=getFunctionByName("SNESJS.CPU.OPS."+b+"_0");this.optable[TBL_EM+a]=this.optable[TBL_MX+a]=this.optable[TBL_Mx+a]=function(){d(c)};var e=getFunctionByName("SNESJS.CPU.OPS."+b+"_1");this.optable[TBL_mX+a]=this.optable[TBL_mx+a]=function(){e(c)}}SNESJS.CPU.prototype.opMI=function(a,b,c){var d=this;var e=getFunctionByName("SNESJS.CPU.OPS."+b+"_0");this.optable[TBL_EM+a]=this.optable[TBL_MX+a]=this.optable[TBL_Mx+a]=function(){e(d,c)};var f=getFunctionByName("SNESJS.CPU.OPS."+b+"_1");this.optable[TBL_mX+a]=this.optable[TBL_mx+a]=function(){f(d,c)}}SNESJS.CPU.prototype.opMII=function(a,b,c,d){var e=this;var f=getFunctionByName("SNESJS.CPU.OPS."+b+"_0");this.optable[TBL_EM+a]=this.optable[TBL_MX+a]=this.optable[TBL_Mx+a]=function(){f(e,c,d)};var g=getFunctionByName("SNESJS.CPU.OPS."+b+"_1");this.optable[TBL_mX+a]=this.optable[TBL_mx+a]=function(){g(e,c,d)}}SNESJS.CPU.prototype.opMF=function(a,b,c){var d=this;var e=getFunctionByName("SNESJS.CPU.OPS."+b+"_0");var f=getFunctionByName("SNESJS.CPU.OPS."+c+"_0");this.optable[TBL_EM+a]=this.optable[TBL_MX+a]=this.optable[TBL_Mx+a]=function(){e(d,f)};var g=getFunctionByName("SNESJS.CPU.OPS."+b+"_1");var h=getFunctionByName("SNESJS.CPU.OPS."+c+"_1");this.optable[TBL_mX+a]=this.optable[TBL_mx+a]=function(){g(d,h)}}SNESJS.CPU.prototype.opMFI=function(a,b,c,d){var e=this;var f=getFunctionByName("SNESJS.CPU.OPS."+b+"_0");var g=getFunctionByName("SNESJS.CPU.OPS."+c+"_0");this.optable[TBL_EM+a]=this.optable[TBL_MX+a]=this.optable[TBL_Mx+a]=function(){f(e,g,d)};var h=getFunctionByName("SNESJS.CPU.OPS."+b+"_1");var i=getFunctionByName("SNESJS.CPU.OPS."+c+"_1");this.optable[TBL_mX+a]=this.optable[TBL_mx+a]=function(){h(e,i,d)}}SNESJS.CPU.prototype.opX=function(a,b){var c=this;var d=getFunctionByName("SNESJS.CPU.OPS."+b+"_0");this.optable[TBL_EM+a]=this.optable[TBL_MX+a]=this.optable[TBL_mX+a]=function(){d(c)};var e=getFunctionByName("SNESJS.CPU.OPS."+b+"_1");this.optable[TBL_Mx+a]=this.optable[TBL_mx+a]=function(){e(c)}}SNESJS.CPU.prototype.opXI=function(a,b,c){var d=this;var e=getFunctionByName("SNESJS.CPU.OPS."+b+"_0");this.optable[TBL_EM+a]=this.optable[TBL_MX+a]=this.optable[TBL_mX+a]=function(){e(d,c)};var f=getFunctionByName("SNESJS.CPU.OPS."+b+"_1");this.optable[TBL_Mx+a]=this.optable[TBL_mx+a]=function(){f(d,c)}}SNESJS.CPU.prototype.opXII=function(a,b,c,d){var e=this;var f=getFunctionByName("SNESJS.CPU.OPS."+b+"_0");this.optable[TBL_EM+a]=this.optable[TBL_MX+a]=this.optable[TBL_mX+a]=function(){f(e,c,d)};var g=getFunctionByName("SNESJS.CPU.OPS."+b+"_1");this.optable[TBL_Mx+a]=this.optable[TBL_mx+a]=function(){g(e,c,d)}}SNESJS.CPU.prototype.opXF=function(a,b,c){var d=this;var e=getFunctionByName("SNESJS.CPU.OPS."+b+"_0");var f=getFunctionByName("SNESJS.CPU.OPS."+c);this.optable[TBL_EM+a]=this.optable[TBL_MX+a]=this.optable[TBL_mX+a]=function(){e(d,f)};var g=getFunctionByName("SNESJS.CPU.OPS."+b+"_1");var h=getFunctionByName("SNESJS.CPU.OPS."+c);this.optable[TBL_Mx+a]=this.optable[TBL_mx+a]=function(){g(d,h)}}SNESJS.CPU.prototype.opXFI=function(a,b,c,d){var e=this;var f=getFunctionByName("SNESJS.CPU.OPS."+b+"_0");var g=getFunctionByName("SNESJS.CPU.OPS."+c);this.optable[TBL_EM+a]=this.optable[TBL_MX+a]=this.optable[TBL_mX+a]=function(){f(e,g,d)};var h=getFunctionByName("SNESJS.CPU.OPS."+b+"_1");var i=getFunctionByName("SNESJS.CPU.OPS."+c);this.optable[TBL_Mx+a]=this.optable[TBL_mx+a]=function(){h(e,i,d)}}SNESJS.CPU.OPS={branch:function(a,b,c){if((a.regs.p&b)!=c){a.last_cycle();a.rd.l=a.op_readpc()}else{a.rd.l=a.op_readpc();a.aa.w=a.regs.pc.d+a.rd.l;a.op_io_cond6(a.aa.w);a.last_cycle();a.op_io();a.regs.pc.w=a.aa.w}},bra:function(a){a.rd.l=a.op_readpc();a.aa.w=a.regs.pc.d+a.rd.l;a.op_io_cond6(aa.w);a.last_cycle();a.op_io();a.regs.pc.w=a.aa.w},brl:function(a){a.rd.l=a.op_readpc();a.rd.h=a.op.readpc();a.last_cycle();a.op_io();a.regs.pc.w=a.regs.pc.d+a.rd.w},jmp_addr:function(a){a.rd.l=a.op_readpc();a.last_cycle();a.rd.h=a.op_readpc();a.regs.pc.w=a.rd.w},jmp_long:function(a){a.rd.l=a.op_readpc();a.rd.h=a.op_readpc();a.last_cycle();a.rd.b=a.op_readpc();a.regs.pc.d=a.rd.d&0xffffff},jmp_iaddr:function(a){a.aa.l=a.op_readpc();a.aa.h=a.op_readpc();a.rd.l=a.op_readaddr(aa.w+0);a.last_cycle();a.rd.h=a.op_readaddr(aa.w+1);a.regs.pc.w=a.rd.w},jmp_iaddrx:function(a){a.aa.l=a.op_readpc();a.aa.h=a.op_readpc();a.op_io();a.rd.l=a.op_readpbr((uint)(aa.w+regs.x.w+0));a.last_cycle();a.rd.h=a.op_readpbr((uint)(aa.w+regs.x.w+1));a.regs.pc.w=a.rd.w},jmp_iladdr:function(a){a.aa.l=a.op_readpc();a.aa.h=a.op_readpc();a.rd.l=a.op_readaddr(a.aa.w+0);a.rd.h=a.op_readaddr(a.aa.w+1);a.last_cycle();a.rd.b=a.op_readaddr(a.aa.w+2);a.regs.pc.d=a.rd.d&0xffffff},jsr_addr:function(a){a.aa.l=a.op_readpc();a.aa.h=a.op_readpc();a.op_io();a.regs.pc.w--;a.op_writestack(a.regs.pc.h);a.last_cycle();a.op_writestack(a.regs.pc.l);a.regs.pc.w=a.aa.w},jsr_long_e:function(a){},jsr_long_n:function(a){},jsr_iaddrx_e:function(a){},jsr_iaddrx_n:function(a){},rti_e:function(a){},rti_n:function(a){},rts:function(a){},rtl_e:function(a){},rtl_n:function(a){},nop:function(a){a.last_cycle();a.op_io_irq()},wdm:function(a){a.last_cycle();a.op_readpc()},xba:function(a){a.op_io();a.last_cycle();a.op_io();a.regs.a.l^=a.regs.a.h;a.regs.a.h^=a.regs.a.l;a.regs.a.l^=a.regs.a.h;a.regs.p.n=(a.regs.a.l&0x80)==0x80;a.regs.p.z=(a.regs.a.l==0)},move_b:function(a,b){a.dp=a.op_readpc();a.sp=a.op_readpc();a.regs.db=a.dp;a.rd.l=a.op_readlong((a.sp<<16)|a.regs.x.w);a.op_writelong(((a.dp<<16)|a.regs.y.w),a.rd.l);a.op_io();a.regs.x.l+=b;a.regs.y.l+=b;a.last_cycle();a.op_io();if(a.regs.a.w--==0x01){a.regs.pc.w-=3}},move_w:function(a,b){a.dp=a.op_readpc();a.sp=a.op_readpc();a.regs.db=a.dp;a.rd.l=a.op_readlong((a.sp<<16)|a.regs.x.w);a.op_writelong((a.dp<<16)|a.regs.y.w,a.rd.l);a.op_io();a.regs.x.w+=a.adjust;a.regs.y.w+=a.adjust;a.last_cycle();a.op_io();if(regs.a.w--==0x01){regs.pc.w-=3}},interrupt_e:function(a,b,c){a.op_readpc();a.op_writestack(a.regs.pc.h);a.op_writestack(a.regs.pc.l);a.op_writestack(a.regs.p);a.rd.l=a.op_readlong(b+0);a.regs.pc.b=0x00;a.regs.p.i=true;a.regs.p.d=false;a.last_cycle();a.rd.h=a.op_readlong(b+1);a.regs.pc.w=rd.w},interrupt_n:function(a,b,c){a.op_readpc();a.op_writestack(a.regs.pc.h);a.op_writestack(a.regs.pc.l);a.op_writestack(a.regs.p);op_writestack(regs.p);a.rd.l=a.op_readlong(c+0);a.regs.pc.b=0x00;a.regs.p.i=true;a.regs.p.d=false;a.last_cycle();a.rd.h=a.op_readlong(c+1);a.regs.pc.w=rd.w},stp:function(a){a.regs.wai=true;while(a.regs.wai){a.last_cycle();a.op_io()}},wai:function(a){a.regs.wai=true;while(a.regs.wai){a.last_cycle();a.op_io()}a.op_io()},xce:function(a){a.last_cycle();a.op_io_irq();var b=a.regs.p.c;a.regs.p.c=a.regs.e;a.regs.e=b;if(a.regs.e){a.regs.p.assign(a.regs.p|0x30);a.regs.s.h=0x01}if(a.regs.p.x){a.regs.x.h=0x00;a.regs.y.h=0x00}a.update_table()},flag:function(a,b,c){a.last_cycle();a.op_io_irq();a.regs.p.assign((regs.p&~b)|c)},pflag_e:function(a,b){a.rd.l=a.op_readpc();a.last_cycle();a.op_io();a.regs.p.assign((b==0x1)?a.regs.p|a.rd.l:a.regs.p&~rd.l);a.regs.p.assign(a.regs.p|0x30);if(a.regs.p.x){a.regs.x.h=0x00;a.regs.y.h=0x00}a.update_table()},pflag_n:function(a,b){a.rd.l=a.op_readpc();a.last_cycle();a.op_io();a.regs.p.assign((b==0x1)?a.regs.p|a.rd.l:a.regs.p&~rd.l);if(a.regs.p.x){a.regs.x.h=0x00;a.regs.y.h=0x00}a.update_table()},transfer_b:function(a,b,c){a.last_cycle();a.op_io_irq();a.regs.r[c].l=a.regs.r[b].l;a.regs.p.n=(a.regs.r[c].l&0x80)==0x80;a.regs.p.z=(a.regs.r[c].l==0)},transfer_w:function(a,b,c){a.last_cycle();a.op_io_irq();a.regs.r[c].w=a.regs.r[b].w;a.regs.p.n=(regs.r[c].w&0x8000)==0x8000;a.regs.p.z=regs.r[c].w==0},tcs_e:function(a){a.last_cycle();a.op_io_irq();a.regs.s.l=a.regs.a.l},tcs_n:function(a){a.last_cycle();a.op_io_irq();a.regs.s.w=a.regs.a.w},tsx_b:function(a){a.last_cycle();a.op_io_irq();a.regs.x.l=a.regs.s.l;a.regs.p.n=(a.regs.x.l&0x80)==0x80;a.regs.p.z=a.regs.x.l==0},tsx_w:function(a){a.last_cycle();a.op_io_irq();a.regs.x.w=a.regs.s.w;a.regs.p.n=(a.regs.x.w&0x8000)==0x8000;a.regs.p.z=a.regs.x.w==0},txs_e:function(a){a.last_cycle();a.op_io_irq();a.regs.s.l=a.regs.x.l},txs_n:function(a){a.last_cycle();a.op_io_irq();a.regs.s.w=a.regs.x.w},push_b:function(a,b){a.op_io();a.last_cycle();a.op_writestack(a.regs.r[b].l)},push_w:function(a,b){a.op_io();a.op_writestack(regs.r[b].h);a.last_cycle();a.op_writestack(regs.r[b].l)},phd_e:function(a){a.op_io();a.op_writestackn(a.regs.d.h);a.last_cycle();a.op_writestackn(a.regs.d.l);a.regs.s.h=0x01},phd_n:function(a){a.op_io();a.op_writestackn(a.regs.d.h);a.last_cycle();a.op_writestackn(a.regs.d.l)}};SNESJS.CPU.Regs=function(){this.pc=new SNESJS.CPU.Reg24();this.p=new SNESJS.CPU.RegFlag();var a=[];this.a=a[0]=new SNESJS.CPU.Reg16();this.x=a[1]=new SNESJS.CPU.Reg16();this.y=a[2]=new SNESJS.CPU.Reg16();this.z=a[3]=new SNESJS.CPU.Reg16();this.s=a[4]=new SNESJS.CPU.Reg16();this.d=a[5]=new SNESJS.CPU.Reg16();this.r=a;this.db=0;this.e=false;this.irq=false;this.wai=false;this.mdr=0;this.z.d=0}SNESJS.CPU.RegFlag=function(){this.n=false;this.v=false;this.m=false;this.x=false;this.d=false;this.i=false;this.z=false;this.c=false}SNESJS.CPU.RegFlag.prototype.assign=function(a){this.n=(a&0x80)==0x80;this.v=(a&0x40)==0x40;this.m=(a&0x20)==0x20;this.x=(a&0x10)==0x10;this.d=(a&0x08)==0x08;this.i=(a&0x04)==0x04;this.z=(a&0x02)==0x02;this.c=(a&0x01)==0x01}SNESJS.CPU.RegFlag.prototype.valueOf=function(){return(this.n?0x80:0x00)|(this.v?0x40:0x00)|(this.m?0x20:0x00)|(this.x?0x10:0x00)|(this.d?0x08:0x00)|(this.i?0x04:0x00)|(this.z?0x02:0x00)|(this.c?0x01:0x00)}SNESJS.CPU.Reg16=function(){this.w=0;this.l=0;this.h=0}SNESJS.CPU.Reg24=function(){this.d=0;this.w=0;this.wh=0;this.l=0;this.h=0;this.b=0;this.bh=0}function uclip24(a){return a&0xffffff}function uclip16(a){return a&0xffff}function uclip8(a){return a&0xff}function getFunctionByName(a){var b=window;var c=Array.prototype.slice.call(arguments).splice(2);var d=a.split(".");var e=d.pop();for(var f=0;f<d.length;f++){b=b[d[f]]}return b[e]}